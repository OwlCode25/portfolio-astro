---
import NavLink from './NavLink.astro';
import OwlIcon from "../components/OwlIcon.astro";

const navLinks = [
  {
    href: "/",
    text: "Home",
    icon: `<svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
      <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
      <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
    </svg>`
  },
  {
    href: "#projects",
    text: "Proyectos",
    icon: `<svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M5 19l2.757 -7.351a1 1 0 0 1 .936 -.649h12.307a1 1 0 0 1 .986 1.164l-.996 5.211a2 2 0 0 1 -1.964 1.625h-14.026a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v2" />
    </svg>`
  },
  {
    href: "#work",
    text: "Experiencia",
    icon: `<svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M3 7m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z" />
      <path d="M8 7v-2a2 2 0 0 1 2 -2h4a2 2 0 0 1 2 2v2" />
      <path d="M12 12l0 .01" />
      <path d="M3 13a20 20 0 0 0 18 0" />
    </svg>`
  },
  {
    href: "#skills",
    text: "Skills",
    icon: `<svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M13 3l0 7l6 0l-8 11l0 -7l-6 0l8 -11" />
    </svg>`
  },
  {
    href: "/contact",
    text: "Contacto",
    icon: `<svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M13 19h-8a2 2 0 0 1 -2 -2v-10a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v6" />
      <path d="M3 7l9 6l9 -6" />
      <path d="M16 22l5 -5" />
      <path d="M21 21.5v-4.5h-4.5" />
    </svg>`,
    isContactLink: true
    }
];
---

<nav class="bg-blue-royal p-3 sm:p-4 md:p-6 shadow-md w-full shadow-blue-navy animate-fade-in-left sticky top-0 z-50">
  <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto px-2 sm:px-3 md:px-4">
    <a href="/" class="flex items-center space-x-2 md:space-x-3 rtl:space-x-reverse border-b border-t border-neutral-light py-1">
      <span class="self-center text-xl md:text-2xl font-semibold whitespace-nowrap text-neutral-white">Owl</span>
      <OwlIcon width="42" height="40" class="w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12" />
      <span class="self-center text-xl md:text-2xl font-semibold whitespace-nowrap text-neutral-white">Code</span>
    </a>
    
    <div class="flex md:order-2 space-x-2 md:space-x-3 rtl:space-x-reverse items-center">
      <a 
        class="transition duration-200 ease-in hover:text-neutral-light hover:bg-neutral-dark bg-slate-50 text-slate-600 rounded-full p-2 mr-10 cursor-pointer block lg:inline-block"
        href="https://www.github.com/OwlCode25" 
        rel="noopener noreferrer" 
        target="_blank"
        aria-label="GitHub Profile"
      >
        <svg class="w-5 h-5 sm:w-6 sm:h-6" viewBox="0 0 24 24" stroke-width="1.5" stroke="#00bfd8" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
          <path d="M5.315 2.1c.791 -.113 1.9 .145 3.333 .966l.272 .161l.16 .1l.397 -.083a13.3 13.3 0 0 1 4.59 -.08l.456 .08l.396 .083l.161 -.1c1.385 -.84 2.487 -1.17 3.322 -1.148l.164 .008l.147 .017l.076 .014l.05 .011l.144 .047a1 1 0 0 1 .53 .514a5.2 5.2 0 0 1 .397 2.91l-.047 .267l-.046 .196l.123 .163c.574 .795 .93 1.728 1.03 2.707l.023 .295l.007 .272c0 3.855 -1.659 5.883 -4.644 6.68l-.245 .061l-.132 .029l.014 .161l.008 .157l.004 .365l-.002 .213l-.003 3.834a1 1 0 0 1 -.883 .993l-.117 .007h-6a1 1 0 0 1 -.993 -.883l-.007 -.117v-.734c-1.818 .26 -3.03 -.424 -4.11 -1.878l-.535 -.766c-.28 -.396 -.455 -.579 -.589 -.644l-.048 -.019a1 1 0 0 1 .564 -1.918c.642 .188 1.074 .568 1.57 1.239l.538 .769c.76 1.079 1.36 1.459 2.609 1.191l.001 -.678l-.018 -.168a5.03 5.03 0 0 1 -.021 -.824l.017 -.185l.019 -.12l-.108 -.024c-2.976 -.71 -4.703 -2.573 -4.875 -6.139l-.01 -.31l-.004 -.292a5.6 5.6 0 0 1 .908 -3.051l.152 -.222l.122 -.163l-.045 -.196a5.2 5.2 0 0 1 .145 -2.642l.1 -.282l.106 -.253a1 1 0 0 1 .529 -.514l.144 -.047l.154 -.03z" stroke-width="0" fill="currentColor" />
        </svg>
      </a>
      <button 
        data-collapse-toggle="navbar-cta" 
        type="button" 
        class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-200 rounded-lg lg:hidden hover:bg-blue-navy hover:text-white focus:outline-none focus:ring-2 focus:ring-blue-navy transition-colors duration-200"
        aria-controls="navbar-cta" 
        aria-expanded="false"
      >
        <span class="sr-only">Open main menu</span>
        <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14">
          <path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"/>
        </svg>
      </button>
    </div>
    
    <div class="items-center justify-between hidden w-full lg:flex lg:w-auto lg:order-1 transition-all duration-300 ease-in-out" id="navbar-cta">
      <ul class="flex flex-col font-medium p-4 lg:p-0 mt-4 border border-blue-navy rounded-lg bg-blue-royal/95 lg:bg-transparent lg:flex-row lg:space-x-6 lg:mt-0 lg:border-0 gap-2 lg:gap-0">
        {navLinks.map(link => (
          <NavLink
            href={link.href}
            text={link.text}
            icon={link.icon}
            isContactLink={link.isContactLink}
          />
        ))}
      </ul>
    </div>
  </div>
</nav>

<script>
  // Script para manejar el desplazamiento suave
  function scrollToSection(event) {
    const targetId = this.getAttribute("href");
    if (targetId.startsWith("#")) {
      event.preventDefault();
      const targetElement = document.querySelector(targetId);

      if (targetElement) {
        const offsetTop = targetElement.offsetTop;
        const navbarHeight = document.querySelector('nav').offsetHeight;

        window.scrollTo({
          top: offsetTop - navbarHeight - 20, // Ajuste para que sea visible por debajo del navbar
          behavior: "smooth"
        });
        
        // Cerrar el menú móvil después de hacer clic
        const menu = document.getElementById('navbar-cta');
        const menuButton = document.querySelector('[data-collapse-toggle="navbar-cta"]');
        if (window.innerWidth < 1024 && menu && menuButton) {
          menu.classList.add('hidden');
          menuButton.setAttribute('aria-expanded', 'false');
        }
      }
    }
  }

  // Navegación mobile toggle con animación
  document.addEventListener('DOMContentLoaded', () => {
    const links = document.querySelectorAll('a[href^="#"]');
    links.forEach(link => {
      link.addEventListener('click', scrollToSection);
    });

    // Toggle para navegación mobile con mejor experiencia de usuario
    const menuButton = document.querySelector('[data-collapse-toggle="navbar-cta"]');
    const menu = document.getElementById('navbar-cta');
    
    if (menuButton && menu) {
      menuButton.addEventListener('click', () => {
        const expanded = menuButton.getAttribute('aria-expanded') === 'true';
        menuButton.setAttribute('aria-expanded', !expanded);
        
        if (expanded) {
          // Cerrar menú
          menu.classList.add('animate-fade-out');
          setTimeout(() => {
            menu.classList.add('hidden');
            menu.classList.remove('animate-fade-out');
          }, 200);
        } else {
          // Abrir menú
          menu.classList.remove('hidden');
          menu.classList.add('animate-fade-in');
          setTimeout(() => {
            menu.classList.remove('animate-fade-in');
          }, 300);
        }
      });
    }
    
    // Manejar cambio de tamaño de ventana para asegurar que el menú sea visible en pantallas grandes
    window.addEventListener('resize', () => {
      if (window.innerWidth >= 1024) {
        menu.classList.remove('hidden');
      } else if (menuButton.getAttribute('aria-expanded') === 'false') {
        menu.classList.add('hidden');
      }
    });
  });
</script>

<style>
  /* Estilos adicionales para animaciones */
  .animate-fade-in {
    animation: fadeIn 0.3s ease-in-out;
  }
  
  .animate-fade-out {
    animation: fadeOut 0.2s ease-in-out;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  @keyframes fadeOut {
    from { opacity: 1; transform: translateY(0); }
    to { opacity: 0; transform: translateY(-10px); }
  }
  
  /* Estilos para el menú móvil mejorado */
  @media (max-width: 1023px) {
    #navbar-cta {
      max-height: calc(100vh - 80px);
      overflow-y: auto;
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      z-index: 100;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }
  }
  
  /* Mejora para dispositivos pequeños */
  @media (max-width: 360px) {
    nav .max-w-screen-xl {
      padding-left: 0.5rem;
      padding-right: 0.5rem;
    }
  }
</style>
